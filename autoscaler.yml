poll_interval_seconds: 60
metric_stores:
  - name: monitoring
    type: prometheus
    prometheus:
      url: http://prometheus:9090

autoscale_rules:
  - service_name: modula-stack_google-docs
    scale_min: 1
    scale_max: 5
    scale_step: 1
    metric_store: monitoring
    metric_query: 100 * avg(system_cpu_usage{job="google-docs"})
    scale_up_threshold: 80
    scale_down_threshold: 50

  - service_name: modula-stack_google-docs
    scale_min: 1
    scale_max: 5
    scale_step: 1
    metric_store: monitoring
    metric_query: kafka_consumergroup_lag_sum{consumergroup="consumer-group-2"}
    scale_up_threshold: 500
    scale_down_threshold: 100
